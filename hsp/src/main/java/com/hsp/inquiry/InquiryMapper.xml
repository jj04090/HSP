<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.hsp.inquiry.InquiryMapper">
    <resultMap id="inquiryResultMap" type="com.hsp.inquiry.Inquiry">
        <result column="INQUIRY_ID" property="inquiry_id" />
        <result column="USER_ID" property="user_id" />
        <result column="PRODUCT_ID" property="product_id" />
        <result column="INQUIRY_TITLE" property="inquiry_title" />
        <result column="INQUIRY_CONTENT" property="inquiry_content" />
        <result column="INQUIRY_REGIT_DATE" property="inquriy_regit_date" />
        <result column="ANSWER" property="answer" />
    </resultMap>

    <sql id="whereSql">
        <where>
            <if test="inquiry_id != null and inquiry_id != ''">
                AND INQUIRY_ID = #{inquiry_id}
            </if>
            <if test="user_id != null and user_id != ''">
                AND USER_ID = #{user_id}
            </if>
            <if test="product_id != null and product_id != ''">
                AND PRODUCT_ID = #{product_id}
            </if>
            <if test="inquiry_title != null and inquiry_title != ''">
                AND INQUIRY_TITLE = #{inquiry_title}
            </if>
            <if test="inquiry_content != null and inquiry_content != ''">
                AND INQUIRY_CONTENT = #{inquiry_content}
            </if>
            <if test="inquriy_regit_date != null and inquriy_regit_date != ''">
                AND INQUIRY_REGIT_DATE = #{inquriy_regit_date}
            </if>
            <if test="answer != null and answer != ''">
                AND ANSWER = #{answer}
            </if>
        </where>
    </sql>

    <select id="list" parameterType="com.hsp.inquiry.Inquiry" resultMap="inquiryResultMap">
        SELECT
            INQUIRY_ID,
            USER_ID,
            PRODUCT_ID,
            INQUIRY_TITLE,
            INQUIRY_CONTENT,
            INQUIRY_REGIT_DATE
        FROM INQUIRY
        <include refid="whereSql" />
    </select>

    <select id="select" parameterType="com.hsp.inquiry.Inquiry" resultMap="inquiryResultMap">
        SELECT
            INQUIRY_ID,
			USER_ID,
			PRODUCT_ID,
  			INQUIRY_TITLE,
  			INQUIRY_CONTENT,
  			INQUIRY_REGIT_DATE,
  			ANSWER
        FROM INQUIRY
        <include refid="whereSql" />
    </select>

    <insert id="insert" parameterType="com.hsp.inquiry.Inquiry">
        INSERT INTO INQUIRY (
            INQUIRY_ID,
			USER_ID,
			PRODUCT_ID,
  			INQUIRY_TITLE,
  			INQUIRY_CONTENT,
  			INQUIRY_REGIT_DATE
        ) VALUES (
            #{inquiry_id},
            #{user_id},
            #{product_id},
            #{inquiry_title},
            #{inquiry_content},
            #{inquiry_regit_date}
        )
    </insert>

    <update id="update" parameterType="com.hsp.inquiry.Inquiry">
        UPDATE MISSION
        <set>
            <if test="inquiry_title != null">
                INQUIRY_TITLE = #{inquiry_title},
            </if>
            <if test="inquiry_content != null">
                INQUIRY_CONTENT = #{inquiry_content},
            </if>
        </set>
        <where>
        	INQUIRY_ID = #{inquiry_id}
        	AND USER_ID = #{user_id}
        	AND PRODUCT_ID = #{product_id}
        </where>
    </update>
    
    <update id="answer" parameterType="com.hsp.inquiry.Inquiry">
        UPDATE MISSION
        <set>
            <if test="answer != null">
                ANSWER = #{answer},
            </if>
        </set>
        <where>
        	INQUIRY_ID = #{inquiry_id}
        	AND USER_ID = #{user_id}
        	AND PRODUCT_ID = #{product_id}
        </where>
    </update>

    <delete id="delete" parameterType="com.hsp.inquiry.Inquiry">
        DELETE FROM INQUIRY
        <where>
        	INQUIRY_ID = #{inquiry_id}
        	AND PRODUCT_ID = #{product_id}
        </where>
        <include refid="whereSql" />
    </delete>
</mapper>